<%- include ('../partials/header', { scripts: ["datatables.min.js", "add-expense.js"], styles: ["datatables.min.css"] }) %>

<span id="user_id" hidden><%=session.user._id %></span>
<div class="d-flex flex-fill" style="overflow-y: auto">
  <div class="container">
    <div class="jumbotron py-4">
      <h1 class="display-3 mb-4"><%=session.user.name.first %>'s expenses</h1>

      <!-- expenses.foreach -->
      <table id="expenses-table" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
        <thead>
          <tr>
            <th scope="col">Title</th>
            <th scope="col">Amount</th>
            <th scope="col">Date</th>
            <th scope="col">Category</th>
            <th></th>
          </tr>
          <tr>
            <th><input type="text" class="form-control" name="title" id="title" placeholder="Title" required></th>
            <th><input type="number" step="0.01" class="form-control" name="amount" id="amount" placeholder="00.00" required></th>
            <th><input type="date" class="form-control" name="date" id="date" required></th>
            <th>
              <div class="dropdown show">
                <select class="form-control" name="category" id="category" placeholder="category" required>
                  <option>Food</option>
                  <option>Utilities</option>
                  <option>Transportation</option>
                  <option>Entertainment</option>
                  <option>Insurance</option>
                  <option>Shopping</option>
                  <option selected>Others</option>
                </select>
              </div>
            </th>
            <th><button type="submit" id="add-btn" class="btn btn-primary m-0">Add</button></th>
          </tr>
        </thead>
        <tbody>
          <% expenses.forEach(function(expense) { if(!expense.disabled) { %>
          <tr class="expense" id="tr-<%= expense._id %>">
            <td><%= expense.title %></td>
            <td><%= expense.amount %></td>
            <td><%= expense.date.toDateString() %></td>
            <td><%= expense.category %></td>
            <td><button id="<%= expense._id %>" onclick="deleteExpense(event)" type="submit" class="btn btn-danger">Delete</button></td>
          </tr>
          <% }}); %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<%- include ('../partials/footer') %>
